<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <title>Chi ti·∫øt phim</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" /> -->
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    * {
      font-family: 'Roboto', sans-serif;
    }

    body {

      background-color: #fff;
      color: #333;
    }

    /* === HEADER === */
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #D9D9D9;
      border-bottom: 1px solid #ddd;
      padding: 2px 30px 0px 30px;
      height: 56px;
      margin-bottom: 5px;
      /* box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); */
    }


    .navbar ul {
      display: flex;
      list-style: none;
      gap: 40px;
      padding: 0;
      margin: 0 0 0 -215px;
    }

    .navbar ul li {
      cursor: pointer;
      font-weight: 500;
      position: relative;
      font-size: 14;
      font-weight: 500;
    }

    .navbar ul li img {
      padding-top: 3px;
      width: 16px;
      height: 16px;
      margin-left: 5px;

    }

    .navbar ul li:hover {
      color: #e43d3d;
    }

    .search-user {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .search-box {
      display: flex;
      align-items: center;
      width: 252.5px;
      height: 30px;
      border-radius: 10px;
      background: #FFF;
      padding: 0 8px;
      box-shadow: 0 0 2px rgba(0, 0, 0, 0.1);
    }

    .search-icon img {
      width: 25px;
      height: 25px;
      margin-top: 3px;
    }

    .notify-icon img {
      width: 25px;
      height: 25px;
    }

    .separator {
      width: 1px;
      height: 100%;
      background-color: black;
      margin: 0 8px;
    }

    .search-box input {
      border: none;
      outline: none;
      flex: 1;
      font-size: 14px;
      background: transparent;
    }

    .user {
      font-size: 14px;
      font-weight: 500;
    }

    .custom-line {
      width: 100%;
      height: 3px;
      background-color: #D9D9D9;
      border: none;
      margin: 20px auto;
      /* cƒÉn gi·ªØa v√† t·∫°o kho·∫£ng c√°ch ph√≠a tr√™n/d∆∞·ªõi */
    }

    .back-arrow {
      position: absolute;
      top: 80px;
      left: 20px;
      color: #333;
      cursor: pointer;
      transition: color 0.2s;
    }

    .back-arrow img {
      width: 48px;
      height: 48px;
    }

    .movie-detail-section {
      display: flex;
      padding: 40px 80px;
      gap: 40px;
      font-family: 'Roboto', sans-serif;
    }

    .poster-wrapper {
      width: 236px;
      height: 354px;
      border-radius: 20px;
      overflow: hidden;
      flex-shrink: 0;
    }

    .poster-detail {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .info-detail h2 {
      /* Gi·ªØ nguy√™n k√≠ch th∆∞·ªõc font, nh∆∞ng tƒÉng kho·∫£ng c√°ch b√™n d∆∞·ªõi */
      color: #000;
      font-family: Roboto;
      font-size: 24px;
      font-style: normal;
      font-weight: 700;
      line-height: normal;
      margin-bottom: 30px;
      /* c√°chÊ†áÈ¢ò 30px */
    }

    .info-detail p {

      margin: 0 0 10px;
      /* t·∫•t c·∫£ c√°c <p> s·∫Ω c√°ch nhau 19px */
    }

    strong {
      color: #000;
      /* m√†u ƒëen cho label */
    }

    .movie-data {
      color: #2357FF;
      /* m√†u xanh cho d·ªØ li·ªáu */
    }


    /* N·∫øu b·∫°n ch·ªâ mu·ªën √°p d·ª•ng margin-bottom:19px cho ƒë√∫ng th·∫ª <p> ch·ª©a ‚Äúƒê·∫°o di·ªÖn‚Äù, th√™m class: */
    .info-detail p.director {
      margin-bottom: 19px;
    }

    .date-list {
      display: flex;
      gap: 85px;
      margin-bottom: 20px;
      margin-left: 80px;
    }

    .date-item {
      width: 66px;
      height: 50px;
      cursor: pointer;
      text-align: center;
      font-weight: bold;
      color: #333;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border-radius: 6px;
      transition: background-color 0.2s ease;
    }

    .date-item:hover {
      background-color: #f0f0f0;
    }



    .date-item.active {
      color: #4285f4;
    }

    .date-item.active::after {
      content: "";
      display: block;
      width: 100%;
      height: 7px;
      background-color: #4285f4;
      margin-top: 3px;
    }

    .showtimes {
      margin-left: 80px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .showtime-group h4 {
      font-size: 16px;
      margin-bottom: 10px;
    }

    .time-buttons {
      display: flex;
      gap: 44px;
      flex-wrap: wrap;
    }

    .time-button {
      width: 115px;
      height: 39px;
      flex-shrink: 0;
      background: #D9D9D9;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      transition: background 0.3s;
    }

    .time-button:hover {
      background: #bcd4fa;
    }

    .movie-description {
      font-family: Roboto;
      font-size: 20px;
      margin-bottom: 19px;
      line-height: 1.5;
    }

    .info-row {
      display: flex;
      margin-bottom: 10px;
      gap: 12px;
    }

    .info-row strong {
      width: 160px;
      color: #000;
      font-weight: 600;
    }

    .info-row span {
      color: #2357FF;
      flex: 1;
    }

    .dropdown-results {
      position: absolute;
      top: 110%;
      /* ngay d∆∞·ªõi search box */
      left: 0;
      width: 100%;
      background: #B0ACAC;
      border-radius: 8px;
      padding: 10px;
      z-index: 1000;
      display: none;
      max-height: 300px;
      overflow-y: auto;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .dropdown-results h4 {
      color: black;
      margin: 0 0 10px;
    }

    .movies-item {
      display: flex;
      gap: 12px;
      margin-bottom: 10px;
      background: transparent;
      border-radius: 5px;
      padding: 5px;
      align-items: center;
    }

    .movies-item img {
      width: 50px;
      height: 70px;
      object-fit: cover;
      border-radius: 4px;
    }

    .movies-info {
      color: black;
    }

    .movies-info h3 {
      margin: 0;
      font-size: 15px;
    }

    .movies-info p {
      margin: 4px 0 0;
      font-size: 13px;
    }

    .not-found {
      color: white;
      font-size: 14px;
      text-align: center;
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <header class="navbar">
    <div class="logo"><img src="icons/logo.svg" /></div>
    <nav>
      <ul>
        <a href="index.html" style="text-decoration: none; color: inherit;">
          <li>TRANG CH·ª¶</li>
        </a>
        <a href="movies.html" style="text-decoration: none; color: inherit;">
          <li>PHIM</li>
        </a>
        <li>TIN M·ªöI</li>
        <a href="HistoryBooking/history.html" style="text-decoration: none; color: inherit;">
          <li>V√â C·ª¶A T√îI</li>
        </a>
        <li>CABA HO√ÄNG MAI <img src="icons/dropdown.svg" alt="Search" /></li>
      </ul>
    </nav>
    <div class="search-user">
      <div class="search-box" style="position: relative;">
        <div class="search-icon">
          <img src="icons/search.svg" alt="Search" />
        </div>
        <div class="separator"></div>
        <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm..." />

        <div id="dropdownResults" class="dropdown-results"></div>
      </div>

      <div class="notify-icon">
        <img src="icons/notify.svg" alt="Notify Icon" />
      </div>
      <div class="user">MINH CHI·∫æN</div>
      <a href="profile.html">
        <div class="user-icon">
          <img src="icons/avatar.svg" alt="User Icon" />
        </div>
      </a>
    </div>

  </header>
  <div class="back-arrow" onclick="window.history.back();">
    <img src="icons/back.png" alt="" style="width: 32px;height: 32px;flex-shrink: 0;aspect-ratio: 24.78/24.78;">
  </div>
  <!-- Ph·∫ßn chi ti·∫øt phim -->
  <section id="movieDetail" class="movie-detail-section"></section>
  <!-- Danh s√°ch ng√†y chi·∫øu -->
  <div class="date-list" id="dateList"></div>
  <hr class="custom-line" />
  <!-- Gi·ªù chi·∫øu -->
  <div class="showtimes" id="showtimes"></div>
  <div id="popup-container"></div>


  <script>
    // 1) D·ªØ li·ªáu phim (ph·∫£i c√≥ tr∆∞·ªùng code v√† genre l√† m·∫£ng)
    const movies = [
      {
        name: "Doraemon: Nobita V√† Cu·ªôc Phi√™u L∆∞u V√†o Th·∫ø Gi·ªõi Trong Tranh",
        code: "T18",
        year: "2025",
        duration: "1h45p",
        durationMinutes: 105,
        poster: "images/movies/dora.png",
        genre: ["Ho·∫°t h√¨nh", "Phi√™u l∆∞u"],
        director: "Yukiyo Teramoto",
        cast: ["Wasabi Mizuta", "Megumi ≈åhara", "Yumi Kakazu", "Subaru Kimura", "Tomokazu Seki"],
        language: "Ti·∫øng Nh·∫≠t",
        releaseDate: "29/05/2025",
        description:
          "Th√¥ng qua m√≥n b·∫£o b·ªëi m·ªõi c·ªßa Doraemon, c·∫£ nh√≥m b·∫°n b∆∞·ªõc v√†o th·∫ø gi·ªõi trong m·ªôt b·ª©c tranh n·ªïi ti·∫øng v√† b·∫Øt g·∫∑p c√¥ b·∫°n b√≠ ·∫©n t√™n Claire. C√πng ƒë·∫øn v∆∞∆°ng qu·ªëc Artoria ƒë·ªÉ t√¨m vi√™n ng·ªçc Artoria Blue, nh√≥m ph√°t hi·ªán ra m·ªôt truy·ªÅn thuy·∫øt h·ªßy di·ªát ƒëang s·ªëng l·∫°i. Li·ªáu h·ªç c√≥ ph√° gi·∫£i ƒë∆∞·ª£c l·ªùi nguy·ªÅn v√† b·∫£o v·ªá th·∫ø gi·ªõi?",
        showtimes: {
          "01/06/2025": {
            IMAX: ["18:30", "20:40", "22:45"],
            "3D": ["19:00", "21:40", "23:00"]
          },
          "02/06/2025": {
            IMAX: ["17:30", "19:40"],
            "3D": ["20:00", "22:00"]
          },
          "03/06/2025": {
            IMAX: ["18:00", "21:00"],
            "3D": ["19:30"]
          }
        }
      },
      {
        name: "Lilo & Stitch",
        code: "VN01",
        year: "2021",
        duration: "1h58p",
        durationMinutes: 118,
        poster: "images/movies/film2.png",
        genre: ["Ho·∫°t h√¨nh", "Gia ƒë√¨nh"],
        director: "Dean DeBlois, Chris Sanders",
        cast: ["Daveigh Chase", "Chris Sanders", "Tia Carrere"],
        language: "Ti·∫øng Anh",
        releaseDate: "01/06/2021",
        description:
          "M·ªôt c√¥ b√© m·ªì c√¥i t√™n Lilo t√¨nh c·ªù g·∫∑p m·ªôt sinh v·∫≠t ngo√†i h√†nh tinh b·ªã th·∫•t l·∫°c ‚Äì Stitch. Hai t√¢m h·ªìn c√¥ ƒë∆°n g·∫Øn k·∫øt v√† c√πng nhau t·∫°o n√™n m·ªôt gia ƒë√¨nh k·ª≥ l·∫° nh∆∞ng ƒë·∫ßy y√™u th∆∞∆°ng.",
        showtimes: {
          "01/06/2021": {
            IMAX: ["17:30", "20:00"],
            "3D": ["18:45", "21:15"]
          }
        }
      },
      {
        name: "L·∫≠t M·∫∑t 8: V√≤ng Tay N√¢ng",
        code: "VN02",
        year: "2024",
        duration: "2h01p",
        durationMinutes: 121,
        poster: "images/movies/film3.png",
        genre: ["H√†nh ƒë·ªông", "T√¢m l√Ω"],
        director: "L√Ω H·∫£i",
        cast: ["·ªêc Thanh V√¢n", "Huy Kh√°nh", "Hu·ª≥nh ƒê√¥ng"],
        language: "Ti·∫øng Vi·ªát",
        releaseDate: "26/04/2024",
        description:
          "Ph·∫ßn 8 c·ªßa lo·∫°t phim 'L·∫≠t M·∫∑t', ti·∫øp t·ª•c k·ªÉ v·ªÅ nh·ªØng m·ªëi quan h·ªá gia ƒë√¨nh, l√≤ng tin v√† s·ª± ph·∫£n b·ªôi. Khi nh·ªØng b√≠ m·∫≠t trong qu√° kh·ª© ƒë∆∞·ª£c ph∆°i b√†y, m·ªçi th·ª© ƒë·ªÅu c√≥ th·ªÉ b·ªã ƒë√°nh ƒë·ªïi.",
        showtimes: {
          "26/04/2024": {
            "2D": ["16:00", "19:00", "21:30"]
          }
        }
      },
      {
        name: "D·∫ø M√®n: Cu·ªôc Phi√™u L∆∞u",
        code: "VN03",
        year: "2023",
        duration: "1h50p",
        durationMinutes: 110,
        poster: "images/movies/film4.png",
        genre: ["Ho·∫°t h√¨nh", "Phi√™u l∆∞u"],
        director: "Nguy·ªÖn Quang D≈©ng",
        cast: ["L·ªìng ti·∫øng b·ªüi nhi·ªÅu ngh·ªá sƒ© Vi·ªát"],
        language: "Ti·∫øng Vi·ªát",
        releaseDate: "10/09/2023",
        description:
          "D·ª±a theo t√°c ph·∫©m n·ªïi ti·∫øng 'D·∫ø M√®n Phi√™u L∆∞u K√Ω', b·ªô phim ho·∫°t h√¨nh Vi·ªát Nam ƒë∆∞a ng∆∞·ªùi xem theo ch√¢n D·∫ø M√®n trong h√†nh tr√¨nh kh√°m ph√° th·∫ø gi·ªõi v√† kh√°m ph√° gi√° tr·ªã b·∫£n th√¢n.",
        showtimes: {
          "10/09/2023": {
            "2D": ["15:00", "17:30", "20:00"]
          }
        }
      },
      {
        name: "Dan Dan Dan: T√† Nh√£n",
        code: "VN04",
        year: "2023",
        duration: "1h42p",
        durationMinutes: 102,
        poster: "images/movies/film7.png",
        genre: ["Ho·∫°t h√¨nh", "H√†i", "H√†nh ƒë·ªông", "Si√™u nhi√™n"],
        director: "Fuga Yamashiro",
        cast: ["Shion Wakayama", "Toshiyuki Toyonaga", "Mikako Komatsu"],
        language: "Ti·∫øng Nh·∫≠t",
        releaseDate: "15/07/2023",
        description:
          "M·ªôt c√¥ g√°i tin v√†o linh h·ªìn v√† m·ªôt ch√†ng trai tin v√†o ng∆∞·ªùi ngo√†i h√†nh tinh b·∫•t ng·ªù b·ªã cu·ªën v√†o chu·ªói s·ª± ki·ªán k·ª≥ l·∫° li√™n quan ƒë·∫øn th·∫ø l·ª±c si√™u nhi√™n v√† ng∆∞·ªùi ngo√†i h√†nh tinh. H·ªç ph·∫£i chi·∫øn ƒë·∫•u ƒë·ªÉ b·∫£o v·ªá nhau v√† gi·∫£i m√£ th·∫ø gi·ªõi ch∆∞a t·ª´ng th·∫•y.",
        showtimes: {
          "01/06/2021": {
            IMAX: ["17:30", "20:00"],
            "3D": ["18:45", "21:15"]
          }
        }
      },
      {
        name: "Mang M·∫π ƒêi B·ªè",
        code: "VN05",
        year: "2023",
        duration: "1h48p",
        durationMinutes: 108,
        poster: "images/movies/film10.png",
        genre: ["Ho·∫°t h√¨nh", "Gia ƒë√¨nh", "T√¨nh c·∫£m"],
        director: "Tr·∫ßn Kh√°nh Duy",
        cast: ["L·ªìng ti·∫øng b·ªüi ngh·ªá sƒ© Vi·ªát nh∆∞ H·ªìng √Ånh, Qu·ªëc Kh√°nh"],
        language: "Ti·∫øng Vi·ªát",
        releaseDate: "20/10/2023",
        description:
          "B√© M√≠t l√™n k·∫ø ho·∫°ch 'mang m·∫π ƒëi b·ªè' v√¨ t·ª©c gi·∫≠n v·ªõi nh·ªØng quy ƒë·ªãnh nghi√™m kh·∫Øc. Tr√™n h√†nh tr√¨nh ƒë√≥, b√© d·∫ßn nh·∫≠n ra nh·ªØng hi sinh th·∫ßm l·∫∑ng c·ªßa m·∫π v√† h·ªçc c√°ch tr∆∞·ªüng th√†nh, y√™u th∆∞∆°ng v√† tha th·ª©.",
        showtimes: {
          "01/06/2021": {
            IMAX: ["17:30", "20:00"],
            "3D": ["18:45", "21:15"]
          }
        }
      }
    ];
    const searchInput = document.getElementById("searchInput");
    const dropdown = document.getElementById("dropdownResults");

    searchInput.addEventListener("input", () => {
      const keyword = searchInput.value.toLowerCase().trim();
      dropdown.innerHTML = "";
      dropdown.style.display = "block";

      if (keyword === "") {
        dropdown.style.display = "none";
        return;
      }

      const filtered = movies.filter(movie =>
        movie.name.toLowerCase().includes(keyword)
      );

      dropdown.innerHTML = `<h4>Danh s√°ch phim</h4>`;

      if (filtered.length === 0) {
        dropdown.innerHTML += `<div class="not-found">R·∫•t ti·∫øc, kh√¥ng t√¨m th·∫•y phim ph√π h·ª£p v·ªõi l·ª±a ch·ªçn c·ªßa b·∫°n</div>`;
      } else {
        filtered.forEach(movie => {
          const movieItem = document.createElement("div");
          movieItem.className = "movies-item";
          movieItem.setAttribute("data-code", movie.code);
          movieItem.innerHTML = `
      <img src="${movie.poster}" alt="${movie.name}">
      <div class="movies-info">
          <h3>${movie.name}</h3>
          <p>${movie.code} ‚Ä¢ ${movie.year} ‚Ä¢ ${movie.duration}</p>
      </div>
  `;
          movieItem.addEventListener("click", () => {
            window.location.href = `chitietmovie.html?code=${movie.code}`;
          });
          dropdown.appendChild(movieItem);
        });
      }
    });

    // ·∫®n dropdown khi click ra ngo√†i
    document.addEventListener("click", function (event) {
      const isClickInside = searchInput.parentElement.contains(event.target);
      if (!isClickInside) {
        dropdown.style.display = "none";
      }
    });

    // 2) L·∫•y code t·ª´ URL
    function getQueryParam(name) {
      return new URLSearchParams(window.location.search).get(name);
    }
    const code = getQueryParam("code");
    const movie = movies.find(m => m.code === code);

    // 3) Render chi ti·∫øt
    function renderMovieDetail(m) {
      const c = document.getElementById("movieDetail");
      if (!m) {
        c.innerHTML = "<h1>Kh√¥ng t√¨m th·∫•y th√¥ng tin phim</h1>"; return;
      }
      c.innerHTML = `
        <div class="poster-wrapper">
  <img src="${m.poster}" alt="${m.name}" class="poster-detail" />
</div>

        <div class="info-detail">
          <h2>${m.name}</h2>
          <p class="movie-description">${m.description}</p>
<div class="info-row"><strong>ƒê·∫†O DI·ªÑN:</strong><span>${m.director}</span></div>
<div class="info-row"><strong>DI·ªÑN VI√äN:</strong><span>${m.cast.join(", ")}</span></div>
<div class="info-row"><strong>TH·ªÇ LO·∫†I:</strong><span>${m.genre.join(", ")}</span></div>
<div class="info-row"><strong>TH·ªúI L∆Ø·ª¢NG:</strong><span>${m.duration}</span></div>
<div class="info-row"><strong>NG√îN NG·ªÆ:</strong><span>${m.language}</span></div>
<div class="info-row"><strong>NG√ÄY KH·ªûI CHI·∫æU:</strong><span>${m.releaseDate}</span></div>
        </div>
      `;
    }

    // 4) Format ng√†y th√†nh dd/mm v√† th·ª©
    function formatDate(dt) {
      const d = new Date(dt);
      const day = String(d.getDate()).padStart(2, "0");
      const mon = String(d.getMonth() + 1).padStart(2, "0");
      const wd = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"][d.getDay()];
      return { label: `${day}/${mon}`, weekday: wd };
    }

    // 5) Render date picker
    function renderDatePicker(showtimes) {
      const dl = document.getElementById("dateList");
      dl.innerHTML = "";
      const dates = Object.keys(showtimes);
      dates.forEach((dt, i) => {
        const { label, weekday } = formatDate(dt);
        const div = document.createElement("div");
        div.className = "date-item" + (i === 0 ? " active" : "");
        div.innerHTML = `<div>${label}</div><div>${weekday}</div>`;
        div.dataset.date = dt;
        div.onclick = () => {
          document.querySelectorAll(".date-item").forEach(e => e.classList.remove("active"));
          div.classList.add("active");
          renderShowtimes(showtimes, dt);
        };
        dl.appendChild(div);
      });
      if (dates.length > 0) renderShowtimes(showtimes, dates[0]);
    }

    // 6) Render showtimes
    function renderShowtimes(showtimes, date) {
      const sw = document.getElementById("showtimes");
      sw.innerHTML = "";
      const data = showtimes[date] || {};
      for (const fmt in data) {
        const grp = document.createElement("div");
        grp.className = "showtime-group";
        grp.innerHTML = `<h4>${fmt}</h4>`;
        const btns = document.createElement("div");
        btns.className = "time-buttons";
        data[fmt].forEach(t => {
          const b = document.createElement("div");
          b.className = "time-button";
          b.textContent = t;

          // G·∫ÆN S·ª∞ KI·ªÜN G·ªåI POPUP
          b.addEventListener("click", () => {
            showSeatPopup(); // G·ªçi popup khi b·∫•m v√†o gi·ªù chi·∫øu
          });

          btns.appendChild(b);
        });

        grp.appendChild(btns);
        sw.appendChild(grp);
      }
    }

    // 7) Kh·ªüi t·∫°o
    renderMovieDetail(movie);
    if (movie) renderDatePicker(movie.showtimes);

  </script>
  <script>
    function showSeatPopup() {
      fetch('popupghe.html')
        .then(response => response.text())
        .then(html => {
          document.getElementById('popup-container').innerHTML = html;

          // T·∫£i file script sau khi HTML ƒë√£ ƒë∆∞·ª£c th√™m v√†o DOM
          const script = document.createElement('script');
          script.src = 'popupghe.js';
          script.onload = () => {
            // Ch·ªâ g·ªçi sau khi popupghe.js ƒë√£ load
            initializeSeats();
            startTimer();
          };
          document.body.appendChild(script);

          // B·∫•m ra ngo√†i popup th√¨ ƒë√≥ng
          const overlay = document.querySelector('.popup-overlay');
          const container = document.querySelector('.popup-container');

          overlay.addEventListener('click', function (e) {
            if (!container.contains(e.target)) {
              clearTimeout(timeoutId);

              // Reset l·∫°i th·ªùi gian
              timeLeft = 300;

              document.getElementById('popup-container').innerHTML = '';
            }
          });
        });
    }

    function showPaymentPopup() {
      fetch('thanhtoan.html')
        .then(res => res.text())
        .then(html => {
          const container = document.getElementById('popup-container');
          container.innerHTML = html;

          // Nh√∫ng script v√† ƒë·∫£m b·∫£o r·∫±ng script ƒë∆∞·ª£c t·∫°o m·ªõi m·ªói l·∫ßn ƒë·ªÉ tr√°nh cache
          const oldScript = document.querySelector('script[src="thanhtoan.js"]');
          if (oldScript) {
            oldScript.remove();
          }

          const script = document.createElement('script');
          script.src = 'thanhtoan.js?v=' + new Date().getTime(); // Th√™m timestamp ƒë·ªÉ tr√°nh cache
          script.onload = () => {
            // Ch·ªâ g·ªçi h√†m sau khi script ƒë√£ load xong v√† DOM ƒë√£ s·∫µn s√†ng
            setTimeout(() => {
              if (typeof initializeThanhToanUI === 'function') {
                initializeThanhToanUI();

              } else {
                console.error('Kh√¥ng t√¨m th·∫•y h√†m initializeThanhToanUI');
              }
            }, 100); // Th√™m timeout nh·ªè ƒë·ªÉ ƒë·∫£m b·∫£o DOM ƒë√£ render xong
          };
          document.body.appendChild(script);

          // Sau khi popup ƒë√£ ƒë∆∞·ª£c th√™m v√†o DOM
          setTimeout(() => {
            const overlay = document.querySelector('.payment-overlay');
            const box = document.querySelector('.payment-popup');

            if (overlay && box) {
              overlay.addEventListener('click', function (e) {
                if (!box.contains(e.target)) {
                  // üëâ Ng∆∞·ªùi d√πng click ra ngo√†i popup thanh to√°n
                  // G·ªçi l·∫°i popup gh·∫ø
                  document.getElementById('popup-container').innerHTML = ''; // X√≥a popup hi·ªán t·∫°i
                  showSeatPopup();

                  // Khi popup gh·∫ø ƒë∆∞·ª£c hi·ªÉn th·ªã l·∫°i, th√™m s·ª± ki·ªán cho n√∫t x√°c nh·∫≠n
                  // setTimeout(() => {
                  //   const confirmButton = document.getElementById('bookButton');
                  //   if (confirmButton) {
                  //     confirmButton.addEventListener('click', function () {
                  //       showPaymentPopup();
                  //     });
                  //   }
                  // }, 100);
                }
              });
            }

            // Th√™m s·ª± ki·ªán cho n√∫t back n·∫øu c√≥ trong popup thanh to√°n
            // const backButton = document.getElementById('backButton');
            // if (backButton) {
            //   backButton.addEventListener('click', function () {
            //     document.getElementById('popup-container').innerHTML = '';
            //     showSeatPopup();
            //   });
            // }
          }, 100); // ƒê·ª£i DOM render xong

        });
    }


  </script>


</body>

</html>